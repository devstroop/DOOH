@layout AdminLayout
@page "/admin/campaigns"
@using DOOH.Server.Models.DOOHDB

@attribute [Authorize]
<PageTitle>Campaigns</PageTitle>
<RadzenRow AlignItems="AlignItems.Center">
    <RadzenColumn Size="12" SizeMD="6">
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
            <RadzenIcon Icon="campaign" Style="font-size: 28px" />
            <RadzenText Text="Campaigns" TextStyle="TextStyle.H4" TagName="TagName.H1" style="margin: 0" />
        </RadzenStack>
    </RadzenColumn>
    <RadzenColumn Size="12" SizeMD="6">
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.End" Gap="0.5rem">
            <RadzenTextBox Placeholder="Search ..." @bind-Value="@search" aria-label="Search" />
            <RadzenButton Icon="search" Click="@Search" />
            <RadzenButton Icon="add" Text="Create" ButtonStyle="ButtonStyle.Primary" Click="@AddButtonClick" class="rz-px-3" />
        </RadzenStack>
    </RadzenColumn>
</RadzenRow>
<RadzenTabs @bind-SelectedIndex="@selectedIndex" Style="margin-top: 1rem;">
    <Tabs>
        <RadzenTabsItem Text="All" Icon="fiber_manual_record" IconColor="black">            
            <RadzenDataList IsLoading="@IsLoading" @ref="@list0" TItem="DOOH.Server.Models.DOOHDB.Campaign" Data="@campaigns" AllowPaging="false" AllowVirtualization="true" LoadData="@campaignsLoadData" Count="@campaignsCount">
                <Template>
                    <CampaignTemplate Campaign="@context" Edit="@OnEdit" Delete="@OnDelete" />
                </Template>
            </RadzenDataList>
        </RadzenTabsItem>
        @foreach (var each in statuses ?? new List<Status>())
        {
            <RadzenTabsItem Text="@each.StatusName" Icon="fiber_manual_record" IconColor="@each.StatusColor" Visible="@(campaigns != null)">
                <RadzenDataList IsLoading="@IsLoading" @ref="@list0" TItem="DOOH.Server.Models.DOOHDB.Campaign" Data="@campaigns.Where(x => x.StatusId == each.StatusId)" AllowPaging="false" AllowVirtualization="true" LoadData="@campaignsLoadData" Count="@campaignsCount" >
                    <Template>
                        <CampaignTemplate Statuses="@statuses" Campaign="@context" Edit="@OnEdit" Delete="@OnDelete" />
                    </Template>
                </RadzenDataList>
                @if (!(campaigns.Where(x => x.StatusId == each.StatusId)).Any())
                {
                    <RadzenCard>
                        <RadzenText Text="No campaigns found" />
                    </RadzenCard>
                }
            </RadzenTabsItem>
        }
    </Tabs>
</RadzenTabs>

<style>
    ul.rz-tabview-nav{
        width: 100%;
        display: flex;
        flex-direction: row;
        overflow-x: auto;
    }
    .rz-tabview-left-icon {
        font-size: 15px;
    }
</style>
